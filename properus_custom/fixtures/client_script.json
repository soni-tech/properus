[
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Item",
  "enabled": 1,
  "modified": "2025-08-23 12:51:33.211197",
  "module": null,
  "name": "refreshsubmit",
  "script": "frappe.ui.form.on('Item', {\r\n    after_save: function(frm) {\r\n        frappe.set_route('List', 'Item'); // kembalikan ke list dan refresh\r\n    }\r\n});\r\n\r\nfrappe.listview_settings['Item'] = {\r\n    onload: function(listview) {\r\n        setInterval(function() {\r\n            listview.refresh();\r\n        }, 10); // refresh tiap 10 detik\r\n    }\r\n};\r\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Item",
  "enabled": 1,
  "modified": "2025-08-23 11:49:43.695446",
  "module": null,
  "name": "refreshlist",
  "script": "frappe.ui.form.on('Item', {\r\n    after_save: function(frm) {\r\n        frappe.set_route('List', 'Item'); // refresh list view utama\r\n    }\r\n});\r\n",
  "view": "List"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Stock Entry",
  "enabled": 1,
  "modified": "2025-08-23 11:59:03.292919",
  "module": null,
  "name": "refreshlagi",
  "script": "frappe.ui.form.on('Stock Entry', {\r\n    after_save: function(frm) {\r\n        frappe.set_route('List', 'Stock Entry'); // kembali ke list view dan refresh\r\n        console.log('List view Stock Entry otomatis refresh setelah Save.');\r\n    }\r\n});\r\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Item",
  "enabled": 1,
  "modified": "2025-08-23 12:01:33.734521",
  "module": null,
  "name": "refreshok",
  "script": "frappe.ui.form.on('Item', {\n\trefresh(frm) {\n\t\t// your code here\n\t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Item",
  "enabled": 1,
  "modified": "2025-08-23 12:02:51.373174",
  "module": null,
  "name": "refreshitem",
  "script": "frappe.ui.form.on('Item', {\r\n    after_save: function(frm) {\r\n        // Setelah simpan Item baru, kembali ke list view dan refresh\r\n        frappe.set_route('List', 'Item');\r\n        console.log('List view Item otomatis refresh setelah Add Item.');\r\n    }\r\n});\r\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Item",
  "enabled": 1,
  "modified": "2025-08-23 12:04:00.080476",
  "module": null,
  "name": "referdf",
  "script": "frappe.ui.form.on('Item', {\r\n    after_save: function(frm) {\r\n        // Setelah simpan Item baru, kembali ke list view dan refresh\r\n        frappe.set_route('List', 'Item');\r\n        console.log('List view Item otomatis refresh setelah Add Item.');\r\n    }\r\n});\r\n",
  "view": "List"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Item",
  "enabled": 1,
  "modified": "2025-08-23 12:11:15.791267",
  "module": null,
  "name": "refreshokok",
  "script": "frappe.ui.form.on('Item', {\r\n    after_save: function(frm) {\r\n        frappe.run_serially([\r\n            () => frappe.set_route('List', 'Item')\r\n        ]);\r\n    }\r\n});\r\n",
  "view": "List"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Item",
  "enabled": 1,
  "modified": "2025-08-23 12:12:15.435363",
  "module": null,
  "name": "refreshlagilagi",
  "script": "frappe.ui.form.on('Item', {\r\n    after_save: function(frm) {\r\n        frappe.run_serially([\r\n            () => frappe.set_route('List', 'Item')\r\n        ]);\r\n    }\r\n});\r\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Item",
  "enabled": 1,
  "modified": "2025-08-23 12:55:16.001653",
  "module": null,
  "name": "kontol",
  "script": "// client script di Item (form)\r\nfrappe.ui.form.on('Item', {\r\n    after_save: function(frm) {\r\n        // kirim sinyal realtime kalau ada item baru\r\n        frappe.realtime.publish('item_added');\r\n        \r\n        // balik ke list\r\n        frappe.set_route('List', 'Item');\r\n    }\r\n});\r\nfrappe.listview_settings['Item'] = {\r\n    onload: function(listview) {\r\n        // dengarkan sinyal realtime\r\n        frappe.realtime.on('item_added', function() {\r\n            listview.refresh();\r\n        });\r\n    }\r\n};\r\n",
  "view": "List"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Item",
  "enabled": 1,
  "modified": "2025-08-23 12:58:21.110979",
  "module": null,
  "name": "MEMEK",
  "script": "frappe.ui.form.on('Item', {\n    after_save: function(frm) {\n        // kirim sinyal realtime kalau ada item baru\n        frappe.realtime.publish('item_added');\n        \n        // balik ke list\n        frappe.set_route('List', 'Item');\n    }\n});",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Item",
  "enabled": 1,
  "modified": "2025-08-23 12:59:25.864716",
  "module": null,
  "name": "MEMEK2",
  "script": "frappe.listview_settings['Item'] = {\n    onload: function(listview) {\n        // dengarkan sinyal realtime\n        frappe.realtime.on('item_added', function() {\n            listview.refresh();\n        });\n    }\n};",
  "view": "List"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Item",
  "enabled": 1,
  "modified": "2025-08-23 13:12:45.790417",
  "module": null,
  "name": "kk",
  "script": "frappe.listview_settings['Item'] = {\r\n    onload: function(listview) {\r\n        frappe.realtime.on('item_added', function() {\r\n            listview.refresh();\r\n        });\r\n    }\r\n};\r\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Item",
  "enabled": 1,
  "modified": "2025-08-23 13:13:04.187606",
  "module": null,
  "name": "kk3",
  "script": "frappe.listview_settings['Item'] = {\r\n    onload: function(listview) {\r\n        frappe.realtime.on('item_added', function() {\r\n            listview.refresh();\r\n        });\r\n    }\r\n};\r\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Item",
  "enabled": 1,
  "modified": "2025-08-23 13:28:26.422114",
  "module": null,
  "name": "dfdf",
  "script": "frappe.listview_settings['Item'] = {\r\n    onload: function(listview) {\r\n        frappe.realtime.on('item_added', function() {\r\n            listview.refresh();\r\n        });\r\n    }\r\n};\r\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Item",
  "enabled": 1,
  "modified": "2025-08-23 13:47:15.623410",
  "module": null,
  "name": "dfdftet",
  "script": "frappe.ui.form.on('Item', {\r\n    after_save: function(frm) {\r\n        // kembali ke List Item\r\n        frappe.set_route('List', 'Item');\r\n\r\n        // tunggu sebentar supaya list terbuka, lalu refresh\r\n        setTimeout(() => {\r\n            const listview = frappe.get_list_view('Item');\r\n            if (listview) {\r\n                listview.refresh(); // sama seperti klik tombol reload\r\n            }\r\n        }, 500); // delay 0.5 detik supaya list sudah siap\r\n    }\r\n});\r\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Item",
  "enabled": 1,
  "modified": "2025-08-23 13:51:13.067732",
  "module": null,
  "name": "tol",
  "script": "// Setelah save Item, set flag dan redirect ke List\r\nfrappe.ui.form.on('Item', {\r\n    after_save: function(frm) {\r\n        sessionStorage.setItem('refresh_item_list', '1');\r\n        frappe.set_route('List', 'Item');\r\n    }\r\n});\r\n\r\n// ListView: cek flag dan refresh otomatis\r\nfrappe.listview_settings['Item'] = {\r\n    onload: function(listview) {\r\n        if (sessionStorage.getItem('refresh_item_list') === '1') {\r\n            listview.refresh();\r\n            sessionStorage.removeItem('refresh_item_list');\r\n        }\r\n    }\r\n};\r\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Item",
  "enabled": 1,
  "modified": "2025-08-23 13:51:33.625704",
  "module": null,
  "name": "tol2",
  "script": "// Setelah save Item, set flag dan redirect ke List\r\nfrappe.ui.form.on('Item', {\r\n    after_save: function(frm) {\r\n        sessionStorage.setItem('refresh_item_list', '1');\r\n        frappe.set_route('List', 'Item');\r\n    }\r\n});\r\n\r\n// ListView: cek flag dan refresh otomatis\r\nfrappe.listview_settings['Item'] = {\r\n    onload: function(listview) {\r\n        if (sessionStorage.getItem('refresh_item_list') === '1') {\r\n            listview.refresh();\r\n            sessionStorage.removeItem('refresh_item_list');\r\n        }\r\n    }\r\n};\r\n",
  "view": "List"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Item",
  "enabled": 1,
  "modified": "2025-08-23 14:14:01.025542",
  "module": null,
  "name": "hobah",
  "script": "frappe.listview_settings['Item'] = {\r\n    onload: function(listview) {\r\n        // load socket.io dari CDN\r\n        let script = document.createElement(\"script\");\r\n        script.src = \"https://cdn.socket.io/4.7.5/socket.io.min.js\";\r\n        script.onload = () => {\r\n            const socket = io(\"http://localhost:3000\");\r\n            socket.on(\"item_added\", function(data) {\r\n                console.log(\"Realtime event received:\", data);\r\n                listview.refresh(); // ini yang bikin list auto refresh\r\n            });\r\n        };\r\n        document.head.appendChild(script);\r\n    }\r\n};\r\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Item",
  "enabled": 1,
  "modified": "2025-08-23 14:16:33.997034",
  "module": null,
  "name": "HOBAH2",
  "script": "frappe.listview_settings['Item'] = {\r\n    onload: function(listview) {\r\n        // load socket.io dari CDN kalau belum ada\r\n        if (typeof io === \"undefined\") {\r\n            let script = document.createElement(\"script\");\r\n            script.src = \"https://cdn.socket.io/4.7.5/socket.io.min.js\";\r\n            script.onload = () => {\r\n                setup_socket(listview);\r\n            };\r\n            document.head.appendChild(script);\r\n        } else {\r\n            setup_socket(listview);\r\n        }\r\n\r\n        function setup_socket(listview) {\r\n            const socket = io(\"http://localhost:3000\");\r\n            socket.on(\"item_added\", function (data) {\r\n                console.log(\"Realtime event received:\", data);\r\n                if (cur_list && cur_list.doctype === \"Item\") {\r\n                    cur_list.refresh(); // refresh langsung list aktif\r\n                }\r\n            });\r\n        }\r\n    }\r\n};\r\n",
  "view": "List"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Item",
  "enabled": 1,
  "modified": "2025-08-23 15:34:18.106356",
  "module": null,
  "name": "ITEM",
  "script": "frappe.ui.form.on('Item', {\r\n    item_group: function(frm) {\r\n        frm.set_query('item_group', function() {\r\n            return {\r\n                filters: {\r\n                    'is_group': 0  // hanya leaf group\r\n                }\r\n            }\r\n        });\r\n    }\r\n});\r\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Purchase Receipt",
  "enabled": 1,
  "modified": "2025-08-24 16:44:32.536600",
  "module": null,
  "name": "purchase receipt change label id",
  "script": "frappe.listview_settings['Purchase Receipt'] = {\r\n    onload(listview) {\r\n        frappe.after_ajax(() => {\r\n            setTimeout(() => {\r\n                listview.$result.find('th').each(function () {\r\n                    if ($(this).text().trim() === \"ID\") {\r\n                        $(this).text(\"Nomor BPB\");\r\n                    }\r\n                });\r\n            }, 500); // delay sedikit biar DOM siap\r\n        });\r\n    }\r\n};\r\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Purchase Receipt",
  "enabled": 1,
  "modified": "2025-08-24 17:00:28.757408",
  "module": null,
  "name": "id change",
  "script": "frappe.listview_settings['Purchase Receipt'] = {\r\n    onload(listview) {\r\n        frappe.after_ajax(() => {\r\n            setTimeout(() => {\r\n                listview.$result.find('th').each(function () {\r\n                    if ($(this).text().trim() === \"ID\") {\r\n                        $(this).text(\"Nomor BPB\");\r\n                    }\r\n                });\r\n            }, 500); // delay sedikit biar DOM siap\r\n        });\r\n    }\r\n};\r\n",
  "view": "List"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Jenis Dokumen Pabean",
  "enabled": 0,
  "modified": "2025-08-28 21:07:46.755466",
  "module": null,
  "name": "hide id jenis dok pabean",
  "script": "    frappe.listview_settings[\"Jenis Dokumen Pabean\"] = {\n        hide_name_column: true\n                hide_uraian_column: true\n\n    };",
  "view": "List"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Workspace",
  "enabled": 1,
  "modified": "2025-08-28 23:14:47.191987",
  "module": null,
  "name": "coba coba",
  "script": "frappe.provide('frappe.ui');\r\n\r\nfrappe.ui.Sidebar.prototype.add_item = function(item) {\r\n    var me = this;\r\n    \r\n    let $item = $(`<div class=\"sidebar-item\">\r\n        <a class=\"sidebar-link\" data-route=\"${item.route || ''}\">\r\n            <span class=\"sidebar-icon\">${item.icon}</span>\r\n            <span class=\"sidebar-label\">${item.label}</span>\r\n        </a>\r\n    </div>`).appendTo(this.$sidebar_list);\r\n\r\n    // Custom click handler\r\n    $item.find('.sidebar-link').on('click', function(e) {\r\n        e.preventDefault();\r\n        \r\n        const menu_label = $(this).find('.sidebar-label').text().trim();\r\n        \r\n        // Daftar menu yang mau langsung ke form baru\r\n        if (['Customer', 'Item', 'Lead', 'Supplier', 'Quotation'].includes(menu_label)) {\r\n            frappe.set_route('Form', menu_label, 'new-' + menu_label.toLowerCase() + '-1');\r\n        } else {\r\n            const route = $(this).attr('data-route');\r\n            if (route) frappe.set_route(route);\r\n        }\r\n    });\r\n};",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Purchase Order",
  "enabled": 1,
  "modified": "2025-08-29 21:10:14.457265",
  "module": null,
  "name": "tes",
  "script": "frappe.listview_settings['doctype'] = {\r\n    onload: function(listview) {\r\n        if (!frappe.user.has_role('Administrator')) {\r\n        // Check if the sidebar toggle button exists\r\n        if ($('.sidebar-toggle-btn').length) {\r\n            // Trigger a click on the sidebar toggle button by default when the list view loads\r\n            $('.sidebar-toggle-btn').click();\r\n            \r\n            // Remove the sidebar toggle button after clicking it\r\n            $('.sidebar-toggle-btn').remove();\r\n            $('.filter-selector').remove();\r\n            $('.menu-btn-group').remove();\r\n            $('.list-liked-by-me').remove();\r\n            $('.use.like-icon').remove();\r\n        }}\r\n    },\r\n    refresh: function(listview) {\r\n        if (!frappe.user.has_role('Administrator')) {\r\n        // Check if the sidebar toggle button exists again on refresh\r\n        if ($('.sidebar-toggle-btn').length) {\r\n            // Trigger a click on the sidebar toggle button by default when the list view is refreshed\r\n            $('.sidebar-toggle-btn').click();\r\n            \r\n            // Remove the sidebar toggle button after clicking it\r\n            $('.sidebar-toggle-btn').remove();\r\n                 $('.filter-selector').remove();\r\n                  $('.menu-btn-group').remove();\r\n        }\r\n    }}\r\n};",
  "view": "List"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Purchase Receipt",
  "enabled": 1,
  "modified": "2025-08-31 16:12:16.654921",
  "module": "properus_custom",
  "name": "nomor aju tanpa -",
  "script": "frappe.ui.form.on('Purchase Receipt', {\r\n    custom_nomor_aju: function(frm) {\r\n        if (frm.doc.custom_nomor_aju) {\r\n            frm.set_value('custom_nomor_aju', frm.doc.custom_nomor_aju.replace(/-/g,''));\r\n        }\r\n    }\r\n});\r\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Stock Entry",
  "enabled": 0,
  "modified": "2025-08-30 18:26:00.841845",
  "module": null,
  "name": "filter brg by no tgl dok",
  "script": "frappe.ui.form.on('Stock Entry', {\r\n    setup: function(frm) {\r\n        frm.set_query('item_code', 'items', function() {\r\n            return {\r\n                query: \"properus_custom.api.purchase_receipt_item.get_items_for_stock_entry\",\r\n                filters: {\r\n                    custom_nomor_dokumen: frm.doc.custom_nomor_dokumen || '',\r\n                    custom_tanggal_dokumen: frm.doc.custom_tanggal_dokumen || ''\r\n                }\r\n            };\r\n        });\r\n    },\r\n\r\n    custom_nomor_dokumen: function(frm) {\r\n        frm.refresh_field('items');\r\n    },\r\n\r\n    custom_tanggal_dokumen: function(frm) {\r\n        frm.refresh_field('items');\r\n    }\r\n});\r\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Stock Entry",
  "enabled": 0,
  "modified": "2025-09-07 05:25:11.384259",
  "module": "properus_custom",
  "name": "gudang by role",
  "script": "frappe.ui.form.on('Stock Entry', {\r\n    refresh: function(frm) {\r\n        let warehouse_value = \"\";\r\n\r\n        // Cek role user\r\n        if (frappe.user.has_role(\"Administrator\")) {\r\n            // Administrator bisa pilih semua → unlock field\r\n            frm.set_value('from_warehouse', \"\");\r\n            let field = frm.get_field('from_warehouse');\r\n            if(field) {\r\n                field.df.read_only = 0;\r\n                field.$input.prop('disabled', false);\r\n            }\r\n        } else if (frappe.user.has_role(\"Gudang Bahan Baku\")) {\r\n            warehouse_value = \"Raw Material - PD\";\r\n        } else if (frappe.user.has_role(\"Gudang Barang Jadi\")) {\r\n            warehouse_value = \"Finished Goods - PD\";\r\n        } else if (frappe.user.has_role(\"Gudang Scrap\")) {\r\n            warehouse_value = \"Scrap - PD\";\r\n        } else if (frappe.user.has_role(\"Gudang WIP\")) {\r\n            warehouse_value = \"WIP - PD\";\r\n        } else if (frappe.user.has_role(\"Exim\")) {\r\n            warehouse_value = \"Exim - PD\";\r\n        }\r\n\r\n        // Set warehouse sesuai role dan lock field\r\n        if(warehouse_value) {\r\n            frm.set_value('from_warehouse', warehouse_value);\r\n            let field = frm.get_field('from_warehouse');\r\n            if(field) {\r\n                field.df.read_only = 1;\r\n                field.$input.prop('disabled', true);\r\n            }\r\n        }\r\n    }\r\n});\r\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Pemasukan Barang",
  "enabled": 1,
  "modified": "2025-08-31 16:12:00.712420",
  "module": "properus_custom",
  "name": "jenis dok",
  "script": "// Custom Script untuk form yang punya field Link ke Jenis Dokumen\r\nfrappe.form.link_formatters['Jenis Dokumen'] = function(value, doc) {\r\n    // ambil kode_dokumen dan uraian dari doc\r\n    let kode = doc.kode_dokumen || \"\";\r\n    let uraian = doc.uraian || \"\";\r\n\r\n    // gabungkan dengan format \"kode - uraian\"\r\n    return kode + (uraian ? \" - \" + uraian : \"\");\r\n};\r\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Pemasukan Barang",
  "enabled": 1,
  "modified": "2025-09-06 03:43:42.596324",
  "module": "properus_custom",
  "name": "pemasukan edit",
  "script": "frappe.ui.form.on(\"Pemasukan Barang\", {\r\n    refresh: function(frm) {\r\n        if (!frm.fields_dict.custom_get_items_from_purchase_receipt) return;\r\n\r\n        const wrapper = frm.fields_dict.custom_get_items_from_purchase_receipt.$wrapper;\r\n        wrapper.empty();\r\n\r\n        // Hanya tombol Submit custom\r\n        wrapper.html(`\r\n            <div style=\"display:flex; gap:5px; width:100%;\">\r\n                <button id=\"btn_submit_list\" style=\"\r\n                    background-color:#ff4081;\r\n                    color:white;\r\n                    border:none;\r\n                    border-radius:20px;\r\n                    padding:4px 10px;\r\n                    font-size:0.8rem;\r\n                    width:100px;\r\n                    height:30px;\r\n                    cursor:pointer;\r\n                \">Submit</button>\r\n            </div>\r\n        `);\r\n\r\n        // Tombol Submit & konfirmasi\r\n        wrapper.find('#btn_submit_list').on('click', function() {\r\n            frappe.confirm(\r\n                `<div style=\"display:flex; align-items:center; gap:10px;\">\r\n                    <span style=\"font-size:1.5rem; color:#ff4081;\">&#9888;</span>\r\n                    <span>Apakah Anda yakin data sudah sesuai? Data akan dikirim ke INSW dan tidak bisa diubah!</span>\r\n                 </div>`,\r\n                function() {\r\n                    frm.save().then(() => {\r\n                        frappe.set_route(\"List\", \"Pemasukan Barang\");\r\n                    });\r\n                },\r\n                function() {\r\n                    frappe.show_alert({message: __(\"Submit dibatalkan\"), indicator:\"orange\"});\r\n                }\r\n            );\r\n        });\r\n    },\r\n\r\n    // Trigger otomatis saat user pilih/isi nomor PR langsung populate child table\r\n    custom_nomor_bukti_penerimaan_barang: function(frm) {\r\n        let pr_name = frm.doc.custom_nomor_bukti_penerimaan_barang;\r\n        if (!pr_name) return;\r\n\r\n        frappe.call({\r\n            method: \"frappe.client.get\",\r\n            args: {\r\n                doctype: \"Purchase Receipt\",\r\n                name: pr_name\r\n            },\r\n            callback: function(r) {\r\n                if (r.message) {\r\n                    let pr = r.message;\r\n\r\n                    // Kosongkan child table dulu\r\n                    frm.clear_table(\"custom_detail_barang\");\r\n\r\n                    // Isi child table sesuai item PR\r\n                    (pr.items || []).forEach(d => {\r\n                        let row = frm.add_child(\"custom_detail_barang\");\r\n                        row.kode_barang = d.item_code;\r\n                        row.kategori_barang = d.item_group;\r\n                        row.nama_barang = d.item_name;\r\n                        row.satuan_barang = d.uom;\r\n                        row.custom_jumlah_pemasukan = d.qty;\r\n                        row.custom_nomor_pr = pr.name;\r\n                    });\r\n\r\n                    frm.refresh_field(\"custom_detail_barang\");\r\n                    frm.set_value(\"custom_tanggal_bukti_penerimaan_barang\", pr.posting_date);\r\n\r\n                    frappe.show_alert({\r\n                        message: __(\"Items berhasil diambil dari PR \" + pr.name),\r\n                        indicator: \"green\"\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    }\r\n});\r\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Pemasukan Barang",
  "enabled": 0,
  "modified": "2025-08-31 19:08:22.721882",
  "module": "properus_custom",
  "name": "input ok ke list",
  "script": "frappe.ui.form.on(\"Pemasukan Barang\", {\r\n    refresh: function(frm) {\r\n        // inject container tombol custom (hanya sekali)\r\n        if (!frm.fields_dict.custom_submit) return;\r\n\r\n        const wrapper = frm.fields_dict.custom_submit.$wrapper;\r\n        wrapper.html(`\r\n            <div id=\"btn_container\" style=\"display:flex; gap:10px;\">\r\n                <button id=\"btn_fetch_pr\" class=\"btn btn-success\" style=\"flex:1;\">Fetch PR</button>\r\n                <button id=\"btn_submit_list\" class=\"btn btn-primary\" style=\"flex:1;\">Submit</button>\r\n            </div>\r\n        `);\r\n\r\n        // Event tombol Fetch PR\r\n        wrapper.find('#btn_fetch_pr').on('click', function() {\r\n            frappe.msgprint(\"Fetch PR clicked!\");\r\n            // panggil fungsi fetch PR sesuai kebutuhan\r\n        });\r\n\r\n        // Event tombol Submit & Kembali\r\n        wrapper.find('#btn_submit_list').on('click', function() {\r\n            frm.save().then(() => {\r\n                frappe.set_route(\"List\", \"Pemasukan Barang\");\r\n            });\r\n        });\r\n    }\r\n});\r\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Pemasukan Barang",
  "enabled": 1,
  "modified": "2025-08-31 19:14:03.559369",
  "module": null,
  "name": "ubah new input",
  "script": "frappe.ui.form.on(\"Pemasukan Barang\", {\r\n    refresh: function(frm) {\r\n        if (frm.doc.__islocal) {\r\n            // delay sedikit biar title default 'New' sudah terbentuk\r\n            setTimeout(() => {\r\n                frm.page.set_title(\"Input \" + frm.doc.doctype);\r\n            }, 100);\r\n        }\r\n    }\r\n});\r\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Pemasukan Barang",
  "enabled": 1,
  "modified": "2025-08-31 19:28:36.341839",
  "module": null,
  "name": "tanggal now",
  "script": "frappe.ui.form.on(\"Pemasukan Barang\", {\r\n    onload: function(frm) {\r\n        // Set default tanggal hari ini hanya untuk form baru\r\n        if (frm.doc.__islocal) {\r\n            if (!frm.doc.custom_tanggal_dokumen) {\r\n                frm.set_value(\"custom_tanggal_dokumen\", frappe.datetime.get_today());\r\n            }\r\n            if (!frm.doc.custom_tanggal_bukti_penerimaan_barang) {\r\n                frm.set_value(\"custom_tanggal_bukti_penerimaan_barang\", frappe.datetime.get_today());\r\n            }\r\n        }\r\n    }\r\n});\r\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Pemasukan Barang",
  "enabled": 0,
  "modified": "2025-08-31 21:16:58.434857",
  "module": null,
  "name": "tes lagi",
  "script": "frappe.ready(() => {\r\n    if (window.location.pathname === \"/app/pemasukan\") {\r\n        frappe.set_route(\"List\", \"Pemasukan Barang\");\r\n    }\r\n});\r\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Stock Entry",
  "enabled": 0,
  "modified": "2025-08-31 22:09:54.817489",
  "module": null,
  "name": "h",
  "script": "frappe.ready(function() {\r\n    // kasih delay biar DOM shortcut sudah dirender\r\n    setTimeout(() => {\r\n        // target semua shortcut di workspace\r\n        document.querySelectorAll('.workspace-shortcut .octicon-arrow-up').forEach(el => {\r\n            // sembunyikan panah default\r\n            el.style.display = 'none';\r\n        });\r\n\r\n        document.querySelectorAll('.workspace-shortcut .octicon').forEach(el => {\r\n            // ganti dengan titik\r\n            el.textContent = '●';        // unicode bullet\r\n            el.style.fontSize = '12px';  // ukuran titik\r\n            el.style.color = 'green';    // warna hijau\r\n        });\r\n    }, 200); // delay 200ms cukup untuk render\r\n});\r\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Stock Opname",
  "enabled": 1,
  "modified": "2025-09-01 21:02:28.437370",
  "module": "properus_custom",
  "name": "fetch data gudang",
  "script": "frappe.ui.form.on('Stock Opname', {\r\n    refresh: function(frm) {\r\n        if (frm.doc.docstatus === 0) {\r\n            frm.add_custom_button('Ambil Data Gudang', () => {\r\n                let d = new frappe.ui.form.MultiSelectDialog({\r\n                    doctype: \"Warehouse\",\r\n                    target: frm,\r\n                    setters: {},\r\n                    get_query() {\r\n                        return { filters: { is_group: 0 } };\r\n                    },\r\n                    primary_action_label: \"Get Items\",\r\n                    action(selections) {\r\n                        if (selections && selections.length > 0) {\r\n                            frappe.call({\r\n                                method: \"frappe.client.get_list\",\r\n                                args: {\r\n                                    doctype: \"Bin\",\r\n                                    fields: [\"item_code\", \"actual_qty\", \"stock_uom\", \"warehouse\"],\r\n                                    filters: {\r\n                                        warehouse: [\"in\", selections]\r\n                                    },\r\n                                    limit_page_length: 9999\r\n                                },\r\n                                callback: function(r) {\r\n                                    if (r.message) {\r\n                                        frm.clear_table(\"items\");\r\n                                        let promises = [];\r\n                                        r.message.forEach(row => {\r\n                                            promises.push(\r\n                                                frappe.db.get_value(\"Item\", row.item_code,\r\n                                                    [\"item_name\", \"item_group\"]\r\n                                                ).then(item => {\r\n                                                    let child = frm.add_child(\"items\");\r\n                                                    child.kode_barang     = row.item_code;\r\n                                                    child.nama_barang     = item.message.item_name;\r\n                                                    child.kategori_barang = item.message.item_group;\r\n                                                    child.satuan_barang   = row.stock_uom;\r\n                                                    child.jumlah_sistem   = row.actual_qty;\r\n                                                    child.gudang          = row.warehouse;\r\n                                                })\r\n                                            );\r\n                                        });\r\n                                        Promise.all(promises).then(() => {\r\n                                            frm.refresh_field(\"items\");\r\n                                        });\r\n                                    }\r\n                                }\r\n                            });\r\n                        } else {\r\n                            frappe.msgprint(\"Tidak ada gudang yang dipilih.\");\r\n                        }\r\n                        d.dialog.hide();\r\n                    }\r\n                });\r\n\r\n                // === Tambahkan tombol Download Excel ===\r\n                d.dialog.set_secondary_action(() => {\r\n                    let selections = d.get_values().selections || [];\r\n                    if (!selections.length) {\r\n                        frappe.msgprint(\"Silakan pilih minimal satu gudang dulu.\");\r\n                        return;\r\n                    }\r\n\r\n                    frappe.call({\r\n                        method: \"frappe.client.get_list\",\r\n                        args: {\r\n                            doctype: \"Bin\",\r\n                            fields: [\"item_code\", \"actual_qty\", \"stock_uom\", \"warehouse\"],\r\n                            filters: {\r\n                                warehouse: [\"in\", selections]\r\n                            },\r\n                            limit_page_length: 9999\r\n                        },\r\n                        callback: function(r) {\r\n                            if (r.message) {\r\n                                let rows = [[\"Kode Barang\", \"Nama Barang\", \"Kategori\", \"Satuan\", \"Jumlah\", \"Gudang\"]];\r\n                                let promises = [];\r\n\r\n                                r.message.forEach(row => {\r\n                                    promises.push(\r\n                                        frappe.db.get_value(\"Item\", row.item_code,\r\n                                            [\"item_name\", \"item_group\"]\r\n                                        ).then(item => {\r\n                                            rows.push([\r\n                                                row.item_code,\r\n                                                item.message.item_name,\r\n                                                item.message.item_group,\r\n                                                row.stock_uom,\r\n                                                row.actual_qty,\r\n                                                row.warehouse\r\n                                            ]);\r\n                                        })\r\n                                    );\r\n                                });\r\n\r\n                                Promise.all(promises).then(() => {\r\n                                    let csv = rows.map(r => r.join(\",\")).join(\"\\n\");\r\n                                    let blob = new Blob([csv], { type: \"text/csv;charset=utf-8;\" });\r\n                                    let link = document.createElement(\"a\");\r\n                                    link.href = URL.createObjectURL(blob);\r\n                                    link.download = \"Stock_Opname.csv\";\r\n                                    link.click();\r\n                                });\r\n                            }\r\n                        }\r\n                    });\r\n                });\r\n\r\n                d.dialog.set_secondary_action_label(\"Download Excel\");\r\n            });\r\n        }\r\n    }\r\n});\r\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Stock Opname",
  "enabled": 1,
  "modified": "2025-09-01 21:37:57.490845",
  "module": "properus_custom",
  "name": "add download",
  "script": "frappe.ui.form.on('Stock Opname', {\r\n    refresh: function(frm) {\r\n\r\n        // Tombol Ambil Data Gudang\r\n        frm.add_custom_button('Ambil Data Gudang', () => {\r\n            let d = new frappe.ui.Dialog({\r\n                title: 'Pilih Gudang',\r\n                fields: [\r\n                    {\r\n                        label: 'Gudang',\r\n                        fieldname: 'warehouses',\r\n                        fieldtype: 'MultiSelect',\r\n                        options: frm.get_link_options(\"Warehouse\") || \"\",\r\n                        reqd: 1\r\n                    }\r\n                ],\r\n                primary_action_label: 'Get Items',\r\n                primary_action(values) {\r\n                    if (!values.warehouses || values.warehouses.length === 0) {\r\n                        frappe.msgprint(\"Silakan pilih minimal satu gudang.\");\r\n                        return;\r\n                    }\r\n\r\n                    frappe.call({\r\n                        method: \"frappe.client.get_list\",\r\n                        args: {\r\n                            doctype: \"Bin\",\r\n                            fields: [\"item_code\", \"actual_qty\", \"stock_uom\", \"warehouse\"],\r\n                            filters: { warehouse: [\"in\", values.warehouses] },\r\n                            limit_page_length: 9999\r\n                        },\r\n                        callback: function(r) {\r\n                            if (r.message) {\r\n                                frm.clear_table(\"items\");\r\n                                let promises = [];\r\n                                r.message.forEach(row => {\r\n                                    promises.push(\r\n                                        frappe.db.get_value(\"Item\", row.item_code, [\"item_name\",\"item_group\"])\r\n                                        .then(item => {\r\n                                            let child = frm.add_child(\"items\");\r\n                                            child.kode_barang     = row.item_code;\r\n                                            child.nama_barang     = item.message.item_name;\r\n                                            child.kategori_barang = item.message.item_group;\r\n                                            child.satuan_barang   = row.stock_uom;\r\n                                            child.jumlah_barang   = row.actual_qty;\r\n                                            child.gudang          = row.warehouse;\r\n                                        })\r\n                                    );\r\n                                });\r\n                                Promise.all(promises).then(() => frm.refresh_field(\"items\"));\r\n                            }\r\n                        }\r\n                    });\r\n\r\n                    d.hide();\r\n                }\r\n            });\r\n            d.show();\r\n        });\r\n\r\n        // Tombol Download Items (Excel-friendly CSV)\r\n        frm.add_custom_button('Download Items', () => {\r\n\r\n            if (!frm.doc.items || frm.doc.items.length === 0) {\r\n                frappe.msgprint(\"Child table kosong.\");\r\n                return;\r\n            }\r\n\r\n            // Header\r\n            let rows = [[\"Kode Barang\",\"Nama Barang\",\"Kategori\",\"Satuan\",\"Jumlah\",\"Gudang\"]];\r\n\r\n            // Data child table\r\n            frm.doc.items.forEach(item => {\r\n                rows.push([\r\n                    item.kode_barang || \"\",\r\n                    item.nama_barang || \"\",\r\n                    item.kategori_barang || \"\",\r\n                    item.satuan_barang || \"\",\r\n                    item.jumlah_barang || 0,\r\n                    item.gudang || \"\"\r\n                ]);\r\n            });\r\n\r\n            // Convert ke CSV\r\n            let csv = rows.map(r => r.map(c => `\"${c}\"`).join(\",\")).join(\"\\n\");\r\n\r\n            // Download file dengan extension .xlsx agar Excel langsung bisa buka\r\n            let blob = new Blob([csv], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8;' });\r\n            let link = document.createElement(\"a\");\r\n            link.href = URL.createObjectURL(blob);\r\n            link.download = \"Stock_Opname_Items.xlsx\";\r\n            document.body.appendChild(link);\r\n            link.click();\r\n            document.body.removeChild(link);\r\n\r\n        }, __(\"Child Table\"));\r\n\r\n    }\r\n});\r\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Stock Opname",
  "enabled": 0,
  "modified": "2025-09-01 21:42:29.811825",
  "module": "properus_custom",
  "name": "ATUR KET width height",
  "script": "frappe.ui.form.on('Stock Opname', {\r\n    onload: function(frm) {\r\n        setTimeout(() => {\r\n            if(frm.fields_dict.keterangan && frm.fields_dict.keterangan.$input) {\r\n                frm.fields_dict.keterangan.$input.css({\r\n                    'height': '80px',   // tinggi tetap\r\n                    'width': '400px'    // lebar tetap\r\n                });\r\n            }\r\n        }, 1000); // 1 detik biar form render sepenuhnya\r\n    }\r\n});\r\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Pengeluaran Barang",
  "enabled": 1,
  "modified": "2025-09-04 15:01:48.197640",
  "module": "properus_custom",
  "name": "tanggal now pengeluarann barang",
  "script": "frappe.ui.form.on(\"Pengeluaran Barang\", {\r\n    onload: function(frm) {\r\n        // Set default tanggal hari ini hanya untuk form baru\r\n        if (frm.doc.__islocal) {\r\n            if (!frm.doc.custom_tanggal_dokumen) {\r\n                frm.set_value(\"tanggal_dokumen\", frappe.datetime.get_today());\r\n            }\r\n            if (!frm.doc.custom_tanggal_bukti_penerimaan_barang) {\r\n                frm.set_value(\"tanggal_bukti_pengeluaran_barang\", frappe.datetime.get_today());\r\n            }\r\n        }\r\n    }\r\n});\r\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Pengeluaran Barang",
  "enabled": 1,
  "modified": "2025-09-06 07:20:42.895863",
  "module": "properus_custom",
  "name": "Pengeluaran edit",
  "script": "frappe.ui.form.on(\"Pengeluaran Barang\", {\r\n    refresh: function(frm) {\r\n        if (!frm.fields_dict.get_items) return;\r\n\r\n        const wrapper = frm.fields_dict.get_items.$wrapper;\r\n        wrapper.empty();\r\n\r\n        // Tombol Submit custom dekat tombol Get Items\r\n        wrapper.html(`\r\n            <div style=\"display:flex; gap:5px; width:100%; flex-wrap: wrap;\">\r\n                <button id=\"btn_submit_list\" style=\"\r\n                    background-color:#ff4081;\r\n                    color:white;\r\n                    border:none;\r\n                    border-radius:20px;\r\n                    padding:4px 10px;\r\n                    font-size:0.8rem;\r\n                    width:120px;\r\n                    height:30px;\r\n                    cursor:pointer;\r\n                \">Submit</button>\r\n            </div>\r\n        `);\r\n\r\n        // Tombol Submit & konfirmasi\r\n        wrapper.find('#btn_submit_list').on('click', function() {\r\n            frappe.confirm(\r\n                `<div style=\"display:flex; align-items:center; gap:10px;\">\r\n                    <span style=\"font-size:1.5rem; color:#ff4081;\">&#9888;</span>\r\n                    <span>Apakah Anda yakin data sudah sesuai? Data akan dikirim ke INSW dan tidak bisa diubah!</span>\r\n                 </div>`,\r\n                function() {\r\n                    frm.save().then(() => {\r\n                        frappe.set_route(\"List\", \"Pengeluaran Barang\");\r\n                    });\r\n                },\r\n                function() {\r\n                    frappe.show_alert({message: __(\"Submit dibatalkan\"), indicator:\"orange\"});\r\n                }\r\n            );\r\n        });\r\n    },\r\n\r\n    // Trigger saat user pilih nomor Delivery Note\r\n    no_bukti_pengeluaran_barang: function(frm) {\r\n        let dn_name = frm.doc.no_bukti_pengeluaran_barang;\r\n        if (!dn_name) return;\r\n\r\n        frappe.call({\r\n            method: \"frappe.client.get\",\r\n            args: {\r\n                doctype: \"Delivery Note\",\r\n                name: dn_name\r\n            },\r\n            callback: function(r) {\r\n                if (r.message) {\r\n                    let dn = r.message;\r\n\r\n                    // Kosongkan child table detail_barang dulu\r\n                    frm.clear_table(\"detail_barang\");\r\n\r\n                    // Isi child table dari items Delivery Note\r\n                    (dn.items || []).forEach(d => {\r\n                        let row = frm.add_child(\"detail_barang\");\r\n                        row.kode_barang = d.item_code;\r\n                        row.kategori_barang = d.item_group;\r\n                        row.nama_barang = d.item_name;\r\n                        row.satuan_barang = d.uom;\r\n                        row.jumlah_barang = d.qty;\r\n                        row.custom_nomor_dn = dn.name;\r\n                    });\r\n\r\n                    frm.refresh_field(\"detail_barang\");\r\n\r\n                    // Opsional: isi tanggal pengeluaran otomatis dari Delivery Note\r\n                    frm.set_value(\"tanggal_bukti_pengeluaran_barang\", dn.posting_date);\r\n\r\n                    frappe.show_alert({\r\n                        message: __(\"Items berhasil diambil dari Delivery Note \" + dn.name),\r\n                        indicator: \"green\"\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    }\r\n});\r\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Stock Entry",
  "enabled": 1,
  "modified": "2025-09-07 05:40:03.150661",
  "module": null,
  "name": "gudang set",
  "script": "frappe.ui.form.on(\"Stock Entry\", {\r\n    setup: function(frm) {\r\n        // Filter khusus untuk from_warehouse\r\n        frm.set_query(\"from_warehouse\", function() {\r\n            if (frappe.user.has_role(\"Gudang Scrap\")) {\r\n                return {\r\n                    filters: {\r\n                        \"warehouse_name\": \"Scrap - PD\"\r\n                    }\r\n                };\r\n            }\r\n        });\r\n\r\n        // Bebasin to_warehouse (selalu semua gudang)\r\n        frm.set_query(\"to_warehouse\", function() {\r\n            return {}; // tidak ada filter\r\n        });\r\n    }\r\n});\r\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Stock Entry",
  "enabled": 1,
  "modified": "2025-09-07 21:21:54.038179",
  "module": null,
  "name": "tombol back",
  "script": "frappe.ui.form.on('Stock Entry', {\r\n    refresh: function(frm) {\r\n        // Cek dulu apakah tombol sudah ada\r\n        if (!frm.$wrapper.find('.btn-back').length) {\r\n            // Tambah tombol Back di toolbar\r\n            $('<button class=\"btn btn-secondary btn-back\" style=\"margin-left:8px;\">Back</button>')\r\n                .appendTo(frm.page.wrapper.find('.page-actions'))\r\n                .on('click', function() {\r\n                    frappe.set_route('List', 'Stock Entry');\r\n                });\r\n        }\r\n    }\r\n});\r\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Stock Entry",
  "enabled": 1,
  "modified": "2025-09-07 21:28:53.206138",
  "module": null,
  "name": "tombol back2",
  "script": "frappe.listview_settings['Stock Entry'] = {\r\n    onload(listview) {\r\n        if (!listview.page.custom_back_btn) {\r\n            listview.page.custom_back_btn = listview.page.set_secondary_action(__('Back'), () => {\r\n                // langsung ke /app/home\r\n                window.location.href = '/app/stok-opname';\r\n            });\r\n        }\r\n    }\r\n};",
  "view": "List"
 }
]